<!-- #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-# -->
<!--               General Info For Each Tour            -->
<!-- #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-# -->

<div class="container">
    <div *ngFor="let tour of tours">
        <div class="tour-info" (click)="toggleTourDetails(tour.id)">
            <div class="test">
                <div class="icon-title">
                    <img src="assets/icons/roadmap.png" alt="" width="30px" />
                    <h5 class="tour-num">{{ tour.name }}</h5>
                </div>
                <span id="tour-date">14 Jan 2024</span>
            </div>

            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <!-- ==*==*==*==*==*      Delivery Personnel Info      *==*==*==*==*==* -->
            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <div class="test">
                <div class="icon-title">
                    <img src="assets/icons/delivery.png" alt="" width="30px" />
                    <h5>Delivery Personnel</h5>
                </div>
                <ul>
                    <li *ngFor="let person of tour.info.deliveryPersonnel">
                        <span
                            id="close-icon"
                            (click)="removeDeliveryPerson(tour.id, person)"
                            >close</span
                        >
                        {{ person }}
                    </li>
                    <span *ngIf="!isOpen" id="add-icon" (click)="show()"
                        >add</span
                    >
                    <span *ngIf="isOpen" id="close-icon" (click)="show()"
                        >close</span
                    >
                </ul>
                <div *ngIf="isOpen">
                    <div
                        *ngFor="let person of availableDeliveryPersonnel"
                        class="deliv-name"
                    >
                        <span id="add-icon" class='add-icon-deliv' (click)="show()">add</span>
                        <label>
                            <input
                                type="checkbox"
                                [value]="person"
                                (change)="
                                    handleCheckboxChange(
                                        tour.id,
                                        person,
                                        $event
                                    )
                                "
                            />

                            {{ person }}
                        </label>
                    </div>
                </div>
            </div>

            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <!-- ==*==*==*==*==*             Truck Info            *==*==*==*==*==* -->
            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <div class="test">
                <div class="icon-title">
                    <img src="assets/icons/truck.png" alt="" width="30px" />
                    <h5>Truck ID</h5>
                </div>
                <select name="" id="">
                    <optgroup label="Trucks IDs">
                        <option value="1">T001</option>
                        <option value="2">T002</option>
                        <option value="3">T003</option>
                    </optgroup>
                </select>
            </div>

            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <!-- ==*==*==*==*==*           Distance Info           *==*==*==*==*==* -->
            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <div class="test">
                <div class="icon-title">
                    <img src="assets/icons/road-map.png" alt="" width="30px" />
                    <h5>Distance</h5>
                </div>
                <span id="distance">{{ tour.info.distance }}</span>
            </div>

            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <!-- ==*==*==*==*==*         Start Time Info           *==*==*==*==*==* -->
            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <div class="test">
                <div class="icon-title">
                    <img src="assets/icons/stop-watch.png" width="30px" />
                    <h5>Start Time</h5>
                </div>
                <span id="start-time">{{ tour.info.startTime }}</span>
            </div>

            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <!-- ==*==*==*==*==*           End Time Info           *==*==*==*==*==* -->
            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <div class="test">
                <div class="icon-title">
                    <img src="assets/icons/time-manager.png" width="30px" />
                    <h5>End Time</h5>
                </div>
                <span id="end-time">{{ tour.info.endTime }}</span>
            </div>

            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <!-- ==*==*==*==*==*           Duration Info           *==*==*==*==*==* -->
            <!-- ==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==*==* -->
            <div class="test">
                <div class="icon-title">
                    <img src="assets/icons/hourglass.png" alt="" width="30px" />
                    <h5>Duration</h5>
                </div>
                <span id="needed-time">{{ tour.info.duration }}</span>
            </div>
        </div>

        <!-- #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-# -->
        <!--              Start  details for each tour           -->
        <!-- #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-# -->
        <div class="tour-details" *ngIf="tour.detailsVisible">
            <table
                cdkDropList
                [cdkDropListData]="tour.info.deliveries"
                (cdkDropListDropped)="drop($event)"
            >
                <tr>
                    <th>Delivery</th>
                    <th>Adress</th>
                    <th>Status</th>
                </tr>
                <tr cdkDrag *ngFor="let delivery of tour.info.deliveries">
                    <td>{{ delivery.id }}</td>
                    <td>{{ delivery.address }}</td>
                    <td>{{ delivery.status }}</td>

                    <ng-template cdkDragPreview>
                        <table>
                            <tr>
                                <td>{{ delivery.id }}</td>
                                <td>{{ delivery.address }}</td>
                                <td>{{ delivery.status }}</td>
                            </tr>
                        </table>
                    </ng-template>
                </tr>
            </table>
        </div>
    </div>
    <!-- =*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=* -->
    <!--                End details for each tour           -->
    <!-- =*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=* -->
</div>

<!-- =*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=* -->
<!--                 Panel de controle                  -->
<!-- =*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=* -->
<br /><br /><br />
<div class="container">
    <div class="control-panel">
        <div class="buttons">
            <button mat-stroked-button (click)="optimizeButton()">
                Optimize
            </button>
            <button mat-stroked-button>Validate</button>
            <button mat-stroked-button>Confirm</button>
        </div>
    </div>
</div>

<!-- <h1>Data from API</h1>
<div>
    {{ data | json }}
</div>
<ng-template #loading><p>Loading...</p></ng-template> -->

<div *ngIf="serverResponse">
    <h3>Server Response:</h3>
    <pre>{{ serverResponse | json }}</pre>
</div>
